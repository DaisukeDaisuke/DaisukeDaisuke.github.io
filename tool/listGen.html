<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

  <title>dq9 list.txtリスト生成</title>

  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="dq9 list.txtリスト生成">
  <meta property="og:description" content="ドラッグ＆ドロップでDQVCアイテム用の_list.txtを生成するツール">
  <meta property="og:url" content="http://daisukedaisuke.github.io/tool/listGen.html">
  <meta property="og:site_name" content="DQVCアイテムリスト生成">
  <meta property="og:locale" content="ja_JP">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="dq9 list.txtリスト生成">
  <meta name="twitter:description" content="ドラッグ＆ドロップでDQVCアイテム用の_list.txtを生成するツール">
  <meta name="twitter:url" content="http://daisukedaisuke.github.io/tool/listGen.html">
  <meta name="twitter:site" content="@Daisuke76897125">
  <meta name="twitter:creator" content="@Daisuke76897125">

  <meta name="description" content="ドラッグ＆ドロップで_list.txtを生成するツール">

  <style>
      :root {
          /* background (true neutral dark) */
          --bg: #0f1113;
          --panel: #12141a;
          --card: #131619;

          /* ui */
          --border: #23282d;

          /* text */
          --text: #e6e9ee;
          --muted: #9aa1aa;   /* 完全グレー寄り */

          /* accent (only place green exists) */
          --accent: #10b981;
          --focus: rgba(16,185,129,0.35);

          /* semantic */
          --warn: #d97706;
          --danger: #ef4444;
      }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      background: linear-gradient(180deg, #0a0b0f 0%, #0e1117 100%);
      color: var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Hiragino Kaku Gothic ProN", "Noto Sans JP", "Yu Gothic UI", "Meiryo", sans-serif;
      letter-spacing: 0.2px;
    }
    .container {
      max-width: 980px;
      margin: 0 auto;
      padding: 24px 16px 80px;
    }
    header.app-header {
      position: sticky;
      top: 0;
      z-index: 10;
      backdrop-filter: blur(6px);
      background: rgba(14,17,23,0.7);
      border-bottom: 1px solid var(--border);
    }
    .app-bar {
      max-width: 980px;
      margin: 0 auto;
      padding: 14px 16px;
      display: flex;
      align-items: center;
      gap: 16px;
    }
    .title {
      font-weight: 700;
      font-size: 18px;
      line-height: 1;
      margin-right: auto;
    }
    .generate-btn {
      background: var(--accent);
      color: #0b0c10;
      border: none;
      border-radius: 10px;
      padding: 10px 16px;
      font-weight: 700;
      cursor: pointer;
      box-shadow: 0 6px 18px rgba(16,185,129,0.35), inset 0 1px 0 rgba(255,255,255,0.25);
      transition: transform .05s ease, box-shadow .2s ease;
    }
    .generate-btn:hover { box-shadow: 0 8px 22px rgba(16,185,129,0.45), inset 0 1px 0 rgba(255,255,255,0.3); }
    .generate-btn:active { transform: translateY(1px); }

    .card {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 14px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.35);
    }

    .dropzone {
      margin-top: 24px;
      padding: 28px;
      border: 2px dashed #2b3345;
      border-radius: 14px;
      text-align: center;
      color: var(--muted);
      min-height: 120px; /* stabilize layout to avoid CLS */
      display: grid;
      place-items: center;
      gap: 10px;
    }
    .dropzone .hint { font-size: 14px; }
    .file-input {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: #1a1f2b;
      border: 1px solid var(--border);
      padding: 10px 14px;
      border-radius: 10px;
    }
    .file-input input[type="file"] { display: none; }
    .file-input label {
      cursor: pointer;
      color: var(--text);
      font-weight: 600;
    }

    .preview {
      margin-top: 22px;
      padding: 16px;
      min-height: 160px; /* stabilize */
    }
    .preview-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 12px;
    }
    .list {
      display: grid;
      gap: 8px;
    }
    .row {
      display: grid;
      grid-template-columns: 1fr auto 160px 40px;
      align-items: center;
      gap: 12px;
      background: var(--panel);
      border: 1px solid #22293a;
      border-radius: 10px;
      padding: 10px 12px;
    }
    .name { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .bytes { color: var(--muted); font-variant-numeric: tabular-nums; }
    select.kind {
      width: 100%;
    background: var(--card);
      color: var(--text);
      border: 1px solid #1f2433;
      border-radius: 8px;
      padding: 8px 10px;
      outline: none;
    }
    select.kind:focus { box-shadow: 0 0 0 3px var(--focus); }
    .delete-btn {
      background: transparent;
      color: var(--danger);
      border: 1px solid #3a1f24;
      border-radius: 8px;
      width: 36px; height: 36px;
      display: grid; place-items: center;
      font-weight: 800; cursor: pointer;
    }
    .delete-btn:hover { background: rgba(239,68,68,0.1); }

    .overlay {
      position: fixed; inset: 0;
      background: rgba(0,0,0,0.75);
      display: none;
      align-items: center; justify-content: center;
      z-index: 50;
    }
    .overlay.show { display: flex; }
    .overlay .overlay-card {
        background: var(--card);
      border: 1px solid var(--border);
      color: var(--text);
      padding: 26px 28px;
      border-radius: 14px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.6);
      max-width: 540px; width: calc(100% - 40px);
      text-align: center;
    }
    .overlay .overlay-card .big { font-size: 18px; font-weight: 700; margin-bottom: 6px; }
    .overlay .overlay-card .small { color: var(--muted); }

    .modal {
      position: fixed; inset: 0; display: none; align-items: center; justify-content: center; z-index: 60;
      background: rgba(0,0,0,0.5);
    }
    .modal.show { display: flex; }
    .modal .dialog {
        background: var(--card);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 18px;
      width: min(560px, calc(100% - 40px));
    }
    .modal .dialog h3 { margin: 4px 0 10px; font-size: 18px; }
    .modal .dialog p { margin: 10px 0; color: var(--muted); }
    .modal .dialog .counts { background:#0f1320; border:1px solid #22293a; border-radius:10px; padding:10px; }
    .modal .dialog .actions { display:flex; gap:10px; justify-content:flex-end; margin-top: 14px; }
    .btn {
        background: var(--panel); color: var(--text); border: 1px solid #2f3750; border-radius: 10px; padding: 8px 14px; cursor: pointer;
    }
    .btn.primary { background: var(--accent); color: #0b0c10; border: none; font-weight: 700; }

    footer.note {
      margin-top: 26px;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.6;
    }
    .kinds { display: grid; grid-template-columns: 1fr; gap: 6px; }
    @media (min-width: 640px) { .kinds { grid-template-columns: repeat(3, 1fr); } }
    .kind-card { background: var(--card);; border:1px solid #22293a; border-radius:10px; padding:10px; }
    .kind-card .label { color: var(--text); font-weight: 700; }
    .kind-card .desc { color: var(--muted); font-size: 13px; margin-top: 4px; }
  </style>
</head>
<body>
  <header class="app-header">
    <div class="app-bar">
      <div class="title">DQVCアイテムリスト生成</div>
      <button class="generate-btn" id="generate-top" type="button">_list.txt生成</button>
    </div>
  </header>

  <div class="container">
    <section class="card dropzone" id="dropzone" aria-label="ファイルのドラッグ＆ドロップ領域">
      <div>
        <div class="hint">ここにファイルをドラッグ＆ドロップ</div>
        <div class="hint">または</div>
        <div class="file-input">
          <label for="file-input">ファイルを選択</label>
          <input id="file-input" type="file" multiple>
        </div>
      </div>
    </section>

    <section class="card preview" aria-label="ファイルプレビュー">
      <div class="preview-header">
        <div style="font-weight:700">プレビュー</div>
        <button class="generate-btn" id="generate-bottom" type="button">_list.txt生成</button>
      </div>
      <div id="list" class="list" aria-live="polite" aria-relevant="additions removals"></div>
    </section>

    <footer class="note">
      <div class="kinds">
        <div class="kind-card">
          <div class="label">auction</div>
          <div class="desc">オークションファイル。</div>
        </div>
        <div class="kind-card">
          <div class="label">quest</div>
          <div class="desc">スペシャルゲストと追加クエスト</div>
        </div>
        <div class="kind-card">
          <div class="label">mes</div>
          <div class="desc">ロクサーヌのウェルカムメッセージ。</div>
        </div>
      </div>
    </footer>
  </div>

  <!-- Drag overlay (predefined to avoid CLS) -->
  <div id="overlay" class="overlay" aria-hidden="true">
    <div class="overlay-card">
      <div class="big">ここにドロップすると追加されます</div>
      <div class="small">TXTのリスト形式をドロップすると現在のリストをリセットします</div>
    </div>
  </div>

  <!-- Confirmation modal (predefined) -->
  <div id="confirm-modal" class="modal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="confirm-title">
    <div class="dialog">
      <h3 id="confirm-title">同一の種類が複数存在します</h3>
      <p>以下の種類が複数あります。続行しますか？</p>
      <div id="duplicate-counts" class="counts"></div>
      <div class="actions">
        <button id="cancel-generate" class="btn" type="button">キャンセル</button>
        <button id="confirm-generate" class="btn primary" type="button">続行</button>
      </div>
    </div>
  </div>

  <script src="listGen.js" defer></script>
</body>
</html>
